# WirePlumber configuration for HP OmniBook FH0xxx audio enhancement
# Uses LV2 plugins for bass enhancement, loudness compensation, and compression

# Prevent quantum from dropping too low during LV2 processing
context.properties = {
  default.clock.min-quantum = 1536
}

# Disable audio suspend to prevent popping on wake
context.modules = [
  {
    name = libpipewire-module-rt
    args = {
      nice.level = -11
    }
    flags = [ ifexists nofail ]
  }
]

monitor.alsa.rules = [
  {
    matches = [
      { node.name = "@DEVICE_NAME@" }
    ]
    actions = {
      update-props = {
        audio.allowed-rates = [44100, 48000, 88200, 96000, 176400, 192000]
        session.suspend-timeout-seconds = 0
      }
    }
  }
]

node.software-dsp.rules = [
  {
    matches = [
      { node.name = "@DEVICE_NAME@" }
    ]
    actions = {
      create-filter = {
        filter-path = "@FILTER_PATH@"
        hide-parent = @HIDE_PARENT@
      }
    }
  }
]

wireplumber.profiles = {
  main = {
    node.software-dsp = "required"
  }
}
